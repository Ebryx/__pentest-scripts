#!/usr/bin/env python3

#############################################
#  python ZoneTransferMassExploiter.py      #
#  input.txt contain list of domains        #
#############################################
import os
import subprocess
fh = open('input.txt','r')
lines = fh.readlines()
fh.close()

outfile = open("output.txt", "w")

lines = [x.strip() for x in lines]
exclude=["akamai.net","edgesuite.net","edgekey.net","akamaiedge.net","akadns.net","akam.net","akamai.com","akamai.net","akamaiedge.net","akamaihd.net","akamaistream.net","akamaitech.net","akamaitechnologies.com","akamaitechnologies.fr","akamaized.net","edgekey.net","edgesuite.net","srip.net","cloudflare.com","awsdns"]

for line in lines:
    result = os.popen('dig  ns +short '+line).read().splitlines()
    for name in result:
        name = name[:-1]
        flag=False
        for e in exclude:
            if e in name:
                flag=True
        if (flag==True):
            continue

        result1 = os.popen("dig axfr @"+name+ "  "+line).read()
        outfile.write(result1+"\r\n")
        outfile.write(";Done: "+line+" NS: "+name+"\r\n--------------------------------------------------------------------")

    outfile.write(";Done: "+line+"\r\n")
    outfile.write('\r\n;===================================================================================\r\n ')
outfile.close()
